(function () {
	$("body").on("click",".js_submit", function(e) {
		e.preventDefault();
		$(".js_error").remove();
		$(".is-invalid").removeClass("is-invalid");
		var formData = new FormData($("form#editProfileForm")[0]);
		// console.log($("#addEditForm").attr("action")); return false;
		$.ajax({
			url : $("#editProfileForm").attr("action"),
			data :formData,
			cache: false,
			contentType: false,
			processData: false,
			type : 'POST',
			dataType : 'json',
			beforeSend  : function (xHR, settings) {
				$("#js_ajax_loader").show();
			},
			error       : function (error) {
			$("#js_ajax_loader").hide();
			},
			complete    : function () {
				$("#js_ajax_loader").hide();
			},
			success     : function (response) {
				if (response.status) {
					Swal.fire('Success',response.success,'success').then((res) => {
						window.location = response.redirect;
					});
				} else{
					$.each(response.error, function( key, value ) {
						$("#editProfileForm").find("#"+key).addClass('is-invalid');
						$("#editProfileForm").find("#"+key).parent("div").find('.invalid-feedback').html(value);
					});
				}
				$('html, body').animate({scrollTop:0}, 'slow');
			}
		});
	});
	$("body").on("click",".js_submit_pass", function(e) {
		e.preventDefault();
		$(".js_error").remove();
		$(".is-invalid").removeClass("is-invalid");
		// $("#editPasswordForm").removeClass('was-validated');
		var formData = new FormData($("form#editPasswordForm")[0]);

		$.ajax({
			url : $("#editPasswordForm").attr("action"),
			data :formData,
			cache: false,
			contentType: false,
			processData: false,
			type : 'POST',
			dataType : 'json',
			beforeSend  : function (xHR, settings) {
				$("#js_ajax_loader").show();
			},
			error       : function (error) {
			$("#js_ajax_loader").hide();
			},
			complete    : function () {
				$("#js_ajax_loader").hide();
			},
			success     : function (response) {
				if (response.status) {
					$("#editPasswordForm")[0].reset();
					Swal.fire('Success',response.success,'success').then((res) => {
						window.location = response.redirect;
					});
				} else{
					$.each(response.error, function( key, value ) {
						$("#editPasswordForm").find("#"+key).addClass('is-invalid');
						$("#editPasswordForm").find("#"+key).parents(".js_validation").find('.invalid-feedback').html(value);
						// $("#editPasswordForm").addClass('was-validated');
					});
				}
				$('html, body').animate({scrollTop:0}, 'slow');
			}
		});
	});

	$("body").on("change","#grad_subject", function(e) {
		var val = $(this).val();
		if(val == "Others") {
			$('#other_subject').parent('div').find('input, div').removeClass('hide');
		} else {
			$('#other_subject').parent('div').find('input, div').addClass('hide');
		}
	});

	$("body").on("change","#grad_year", function(e) {
		var val = $(this).val();
		if(val == "Others") {
			$('#other_year').parent('div').find('input, div').removeClass('hide');
		} else {
			$('#other_year').parent('div').find('input, div').addClass('hide');
		}
	});

	$(".progrss").each(function () {

		var value = $(this).attr('data-value');
		var left = $(this).find('.progrss-left .progrss-bar');
		var right = $(this).find('.progrss-right .progrss-bar');

		if (value > 0) {
			if (value <= 50) {
				right.css('transform', 'rotate(' + percentageToDegrees(value) + 'deg)')
			} else {
				right.css('transform', 'rotate(180deg)')
				left.css('transform', 'rotate(' + percentageToDegrees(value - 50) + 'deg)')
			}
		}

	})

	function percentageToDegrees(percentage) {

		return percentage / 100 * 360

	}

	

	$("body").on("change","#js_change_course", function(e) {
		e.preventDefault();
		var course_id = $(this).val();
		var url = $('#lms-ajax-url').val();
		if (course_id) {
			$.ajax({
				url : url,
				data :{course_id:course_id},
				type : 'get',
				// dataType : 'json',
				beforeSend  : function (xHR, settings) {
					$("#js_ajax_loader").show();
				},
				error       : function (error) {
					$("#js_ajax_loader").hide();
				},
				complete    : function () {
					$("#js_ajax_loader").hide();
				},
				success     : function (response) {
					$("#js_video_container").html(response);
					$("#js_ajax_loader").hide();		
				}
			});
			// $.ajax({
			// 	url : 'https://api.spotlightr.com/api/videos',
			// 	data :{vooKey:'MFHXYd2wcDzuBSbTfmX1vQ0X2', videoID: 1421617},
			// 	type : 'get',
			// 	// dataType : 'json',
			// 	error       : function (error) {
			// 		console.log(error);
			// 	},
			// 	success     : function (response) {
			// 		console.log(response);
			// 	}
			// });
		}
	});

})();